–û—Ç–ª–∏—á–Ω–æ! –í—ã–±–æ—Ä CoW + MVCC –¥–ª—è `b-plus-tree` ‚Äî —ç—Ç–æ –º–æ—â–Ω–æ–µ –∏ –≥–∏–±–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ, —Ö–æ—Ç—è –∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –û–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç –≤—ã—Å–æ–∫–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —á—Ç–µ–Ω–∏–π, –∏ —Å–∏–ª—å–Ω—ã–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏–∑–æ–ª—è—Ü–∏–∏.

–í–æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ—Ä–∞–±–æ—Ç–∫–µ `b-plus-tree` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ CoW + MVCC –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `collection-store`):

**I. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –°—Ç—Ä—É–∫—Ç—É—Ä–µ –î–∞–Ω–Ω—ã—Ö –∏ –ö–ª–∞—Å—Å–µ `Node` (`src/Node.ts`)**

1.  **–ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å (Immutability) –£–∑–ª–æ–≤:**
    *   –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø CoW: —É–∑–ª—ã –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è "–Ω–∞ –º–µ—Å—Ç–µ". –õ—é–±–∞—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤–æ–≥–æ —É–∑–ª–∞ (–∫–æ–ø–∏–∏).
    *   –í—Å–µ –º–µ—Ç–æ–¥—ã, –∏–∑–º–µ–Ω—è—é—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–∑–ª–∞ (`keys`, `pointers`, `children`, `min`, `max`, `_parent`, `_left`, `_right`), –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å *–Ω–æ–≤—ã–π* —ç–∫–∑–µ–º–ø–ª—è—Ä `Node` —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.
    *   –£–±–µ—Ä–∏—Ç–µ –ø—Ä—è–º—ã–µ –º—É—Ç–∞—Ü–∏–∏ —Ç–∏–ø–∞ `this.keys.splice(...)` –∏–∑ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–ª–∏ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–π—Ç–µ –∏—Ö —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–∞ –∫–æ–ø–∏–∏, —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–π –≤ –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞.

2.  **–°–æ–∑–¥–∞–Ω–∏–µ –ö–æ–ø–∏–π –£–∑–ª–æ–≤:**
    *   –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ `Node.copy(originalNode: Node<T, K>, transactionContext: TransactionContext): Node<T, K>`.
    *   –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π `Node`, –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –µ–≥–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø–æ–ª—è.
        *   `keys`, `pointers`, `children` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –Ω–æ–≤—ã–µ –º–∞—Å—Å–∏–≤—ã (–Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—Å—ã–ª–∫–∏).
        *   `id` —É–∑–ª–∞:
            *   **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1 (–ù–æ–≤—ã–µ ID –¥–ª—è –∫–æ–ø–∏–π):** –ö–∞–∂–¥–∞—è –∫–æ–ø–∏—è –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `id` –∏–∑ `tree.get_next_id()`. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ –¥–µ—Ç–µ–π –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —É–∑–ª–∞—Ö (–∫–æ—Ç–æ—Ä—ã–µ —Ç–æ–∂–µ –±—É–¥—É—Ç –∫–æ–ø–∏—è–º–∏).
            *   **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2 (–õ–æ–≥–∏—á–µ—Å–∫–∏–µ ID):** –£–∑–ª—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å "–ª–æ–≥–∏—á–µ—Å–∫–∏–π ID", –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏, –∞ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ –º–æ–∂–µ—Ç —É—Å–ª–æ–∂–Ω–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `tree.nodes`. –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1 –æ–±—ã—á–Ω–æ –ø—Ä–æ—â–µ –¥–ª—è CoW. *–î–∞–ª–µ–µ –±—É–¥–µ–º –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—Ç—å –°—Ç—Ä–∞—Ç–µ–≥–∏—é 1.*
        *   `tree`: –ö–æ–ø–∏—è —É–∑–ª–∞ –¥–æ–ª–∂–Ω–∞ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä `BPlusTree`, –Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–µ–π –¥–æ–ª–∂–Ω—ã —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
    *   `_left`, `_right`, `_parent` —É –∫–æ–ø–∏–π: –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–ª–∏ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ ID –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤. –ò—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–æ–ø–∏–∏ –≤ "—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—É—é" –≤–µ—Ä—Å–∏—é –¥–µ—Ä–µ–≤–∞.

3.  **–ö–æ–Ω—Ç–µ–∫—Å—Ç –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –£–∑–ª–æ–≤:**
    *   –£–∑–ª—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–∞–∫-—Ç–æ —Å –Ω–µ–π —Å–≤—è–∑–∞–Ω—ã –∏–ª–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –∫—ç—à/–º–µ–Ω–µ–¥–∂–µ—Ä —É–∑–ª–æ–≤.
    *   –í–æ–∑–º–æ–∂–Ω–æ, –æ–±—ä–µ–∫—Ç `BPlusTree` –±—É–¥–µ—Ç –∏–º–µ—Ç—å –º–µ—Ç–æ–¥ —Ç–∏–ø–∞ `getNodeForTransaction(nodeId: number, txCtx: TransactionContext): Node<T, K>`, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω–µ—Ç –ª–∏–±–æ –∫–æ–ø–∏—é —É–∑–ª–∞ –∏–∑ —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –ª–∏–±–æ (–µ—Å–ª–∏ —É–∑–µ–ª –Ω–µ –º–µ–Ω—è–ª—Å—è –≤ —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏) –æ—Ä–∏–≥–∏–Ω–∞–ª –∏–∑ "—Å–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ" —Å–æ—Å—Ç–æ—è–Ω–∏—è.

**II. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ö–ª–∞—Å—Å–µ `BPlusTree` (`src/BPlusTree.ts`)**

1.  **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°–Ω–∞–ø—à–æ—Ç–∞–º–∏/–í–µ—Ä—Å–∏—è–º–∏:**
    *   `tree.nodes = new Map<number, Node<T, K>>()`: –≠—Ç–∞ –∫–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å *–ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ* –¥–µ—Ä–µ–≤–∞.
    *   `tree.root: number`: –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ ID –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —É–∑–ª–∞ *–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è*.
    *   –î–ª—è –∫–∞–∂–¥–æ–π –∞–∫—Ç–∏–≤–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞—é—â–µ–π —Å —ç—Ç–∏–º –¥–µ—Ä–µ–≤–æ–º, –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å "–µ–µ" –≤–µ—Ä—Å–∏—é –¥–µ—Ä–µ–≤–∞, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑:
        *   –ö–æ–ø–∏–π —É–∑–ª–æ–≤, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π.
        *   –°—Å—ã–ª–æ–∫ –Ω–∞ –Ω–µ–∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —É–∑–ª—ã –∏–∑ —Å–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞—á–∞–ª—Å—è —Å–Ω–∞–ø—à–æ—Ç —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
    *   –≠—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–¥–∞—á—É `TransactionContext` –≤–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.

2.  **`TransactionContext`:**
    *   –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `TransactionContext`:
      ```typescript
      interface TransactionContext<T, K extends ValueType> {
          readonly transactionId: string; // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–æ—Ç collection-store)
          readonly snapshotRootId: number; // ID –∫–æ—Ä–Ω—è B+-–¥–µ—Ä–µ–≤–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (—Å–Ω–∞–ø—à–æ—Ç)

          // –ö–∞—Ä—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö/–Ω–æ–≤—ã—Ö —É–∑–ª–æ–≤ –≤ —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (originalNodeId -> copiedNode)
          // –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ (newNodeId -> newNode), –µ—Å–ª–∏ ID —É –∫–æ–ø–∏–π –≤—Å–µ–≥–¥–∞ –Ω–æ–≤—ã–µ.
          workingNodes: Map<number, Node<T, K>>;

          // –ù–æ–≤—ã–π –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ –¥–ª—è —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è)
          newRootId?: number;

          // –î—Ä—É–≥–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, read set/write set –¥–ª—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è)
          getCommittedNode(nodeId: number): Node<T, K> | undefined; // –ü–æ–ª—É—á–∏—Ç—å —É–∑–µ–ª –∏–∑ —Å–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
          getWorkingNode(nodeId: number): Node<T, K> | undefined; // –ü–æ–ª—É—á–∏—Ç—å —É–∑–µ–ª –∏–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
          addWorkingNode(node: Node<T, K>): void; // –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π/–∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π —É–∑–µ–ª –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä
      }
      ```
    *   –≠–∫–∑–µ–º–ø–ª—è—Ä `TransactionContext` –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å B+-–¥–µ—Ä–µ–≤–æ–º –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ `collection-store`.

3.  **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ú–µ—Ç–æ–¥–æ–≤ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`insert`, `remove`, `removeMany`, `actions.remove`, `actions.update`):**
    *   –í—Å–µ —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω–∏–º–∞—Ç—å `TransactionContext` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞.
    *   –û–Ω–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –Ω–∞–ø—Ä—è–º—É—é —Å `this.nodes` –∏ `this.root`, –∞ —Å —É–∑–ª–∞–º–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ `transactionContext` (—Å–Ω–∞—á–∞–ª–∞ `getWorkingNode`, –µ—Å–ª–∏ –Ω–µ—Ç - `getCommittedNode`, –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é —á–µ—Ä–µ–∑ `Node.copy` –∏ `addWorkingNode`).
    *   –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∏—Ö —Ä–∞–±–æ—Ç—ã –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `transactionContext.workingNodes` –∏, –≤–æ–∑–º–æ–∂–Ω–æ, `transactionContext.newRootId`.
    *   –û–Ω–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –∏–∑–º–µ–Ω—è—Ç—å `this.nodes` –∏–ª–∏ `this.root`.
    *   –û–Ω–∏ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å–ø–µ—Ö–µ –∏, –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –æ –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö (–¥–ª—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –≤ `collection-store`).
    *   _(‚úÖ –ì–û–¢–û–í–û: `BPlusTree.insert_in_transaction` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç)_
    *   _(‚úÖ –ì–û–¢–û–í–û: –í—Å–µ —Å–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —É–∑–ª—ã, –≥–ª—É–±–æ–∫–∏–µ –¥–µ—Ä–µ–≤—å—è, –∏–∑–æ–ª—è—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)_
    *   _(‚úÖ –ì–û–¢–û–í–û: `BPlusTree.get_all_in_transaction` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≤—Å–µ 8 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)_
    *   _(‚úÖ –ì–û–¢–û–í–û: 2PC API —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω - –í–°–ï 24 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç!)_
    *   _(üéØ PHASE 2 –ó–ê–í–ï–†–®–ï–ù–ê: –í—Å–µ 49 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç - –ø–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å!)_
    *   _(–ü–µ—Ä–µ—Ö–æ–¥ –∫ Phase 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å collection-store –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)_

4.  **API –¥–ª—è –î–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –ö–æ–º–º–∏—Ç–∞ (2PC):**
    *   `prepareCommit(transactionId: string): Promise<boolean>`:
        *   –ù–∞—Ö–æ–¥–∏—Ç `TransactionContext` –ø–æ `transactionId` (B+-–¥–µ—Ä–µ–≤–æ –¥–æ–ª–∂–Ω–æ –≥–¥–µ-—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ/–ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã).
        *   –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞). –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –¥—Ä—É–≥–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∑–∞–∫–æ–º–º–∏—Ç–∏–≤—à–∏–µ—Å—è –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∏–∑–º–µ–Ω–∏–ª–∏ —É–∑–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —á–∏—Ç–∞–ª–∞ (–¥–ª—è Snapshot Isolation —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π read-set).
        *   –ï—Å–ª–∏ –≤—Å–µ –≥–æ—Ç–æ–≤–æ, –ø–æ–º–µ—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–∞–∫ "prepared" –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true`. –ò–Ω–∞—á–µ `false`.
    *   `commit(transactionId: string): Promise<void>`:
        *   –ù–∞—Ö–æ–¥–∏—Ç "prepared" `TransactionContext`.
        *   "–ê—Ç–æ–º–∞—Ä–Ω–æ" –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è:
            *   –û–±–Ω–æ–≤–ª—è–µ—Ç `this.root = transactionContext.newRootId ?? this.root`.
            *   –í–ª–∏–≤–∞–µ—Ç `transactionContext.workingNodes` –≤ `this.nodes` (–∑–∞–º–µ–Ω—è—è —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —É–∑–ª–æ–≤, –µ—Å–ª–∏ ID –Ω–µ –º–µ–Ω—è–ª–∏—Å—å, –∏–ª–∏ –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ –∏ —É–¥–∞–ª—è—è —Å—Ç–∞—Ä—ã–µ, –µ—Å–ª–∏ ID —É –∫–æ–ø–∏–π –Ω–æ–≤—ã–µ).
            *   –û—á–∏—â–∞–µ—Ç "—Å—Ç–∞—Ä—ã–µ" –≤–µ—Ä—Å–∏–∏ —É–∑–ª–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ—Ç —Å—Å—ã–ª–æ–∫ –∏ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–Ω—ã –¥—Ä—É–≥–∏–º –∞–∫—Ç–∏–≤–Ω—ã–º —Å–Ω–∞–ø—à–æ—Ç–∞–º (—ç—Ç–æ —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å - —Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞ –≤–µ—Ä—Å–∏–π).
        *   –£–¥–∞–ª—è–µ—Ç `TransactionContext` –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö.
    *   `rollback(transactionId: string): Promise<void>`:
        *   –ù–∞—Ö–æ–¥–∏—Ç `TransactionContext`.
        *   –ü—Ä–æ—Å—Ç–æ —É–¥–∞–ª—è–µ—Ç `TransactionContext` (–≤—Å–µ CoW-–∫–æ–ø–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º, –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–æ–±—Ä–∞–Ω—ã —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ JS, –µ—Å–ª–∏ –Ω–∞ –Ω–∏—Ö –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö —Å—Å—ã–ª–æ–∫).
        *   –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `this.nodes` –∏–ª–∏ `this.root` –Ω–µ –≤–Ω–æ—Å–∏—Ç—Å—è.

5.  **–ú–µ—Ç–æ–¥—ã –ß—Ç–µ–Ω–∏—è (`find`, `findFirst`, `list`, `cursor` –∏ —Ç.–¥.):**
    *   –ï—Å–ª–∏ —á—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`TransactionContext` –ø–µ—Ä–µ–¥–∞–Ω):
        *   –ß—Ç–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∏–∑ —Å–Ω–∞–ø—à–æ—Ç–∞ —ç—Ç–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (—Ç.–µ. –∏—Å–ø–æ–ª—å–∑—É—è `transactionContext.snapshotRootId` –∫–∞–∫ —Å—Ç–∞—Ä—Ç–æ–≤—É—é —Ç–æ—á–∫—É –∏ —É–∑–ª—ã –∏–∑ `transactionContext.workingNodes` –ø–æ–≤–µ—Ä—Ö `getCommittedNode`).
    *   –ï—Å–ª–∏ —á—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∏–ª–∏ `TransactionContext` –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω):
        *   –ß—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–æ–º–º–∏—á–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (`this.root`, `this.nodes`).

**III. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `methods.ts` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–µ—Ä–µ–≤–∞)**

1.  **–ü–µ—Ä–µ–¥–∞—á–∞ `TransactionContext`:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–µ—Ä–µ–≤–∞ (`split`, `merge_with_left/right`, `borrow_from_left/right`, `reflow`, `try_to_pull_up_tree`, `find_first_node` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø–∏—Å–∏) –∏ —Ç.–¥.), –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω–∏–º–∞—Ç—å `TransactionContext`.
2.  **–†–∞–±–æ—Ç–∞ —Å –ö–æ–ø–∏—è–º–∏:**
    *   –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∞—Ç—å —É–∑–ª—ã —á–µ—Ä–µ–∑ `transactionContext`.
    *   –õ—é–±–∞—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —É–∑–ª–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Å–æ–∑–¥–∞–Ω–∏—é –µ–≥–æ –∫–æ–ø–∏–∏ (`Node.copy(..., transactionContext)`), –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –∫–æ–ø–∏–∏ –≤ `transactionContext.workingNodes`, –∏ –≤–æ–∑–≤—Ä–∞—Ç—É —ç—Ç–æ–π –∫–æ–ø–∏–∏ (–∏–ª–∏ –µ–µ ID).
    *   –ù–∞–ø—Ä–∏–º–µ—Ä, `split(tree, node, txCtx)`:
        *   –ü–æ–ª—É—á–∞–µ—Ç `node` (–∏–ª–∏ –µ–≥–æ –∫–æ–ø–∏—é –∏–∑ `txCtx`).
        *   –°–æ–∑–¥–∞–µ—Ç –∫–æ–ø–∏—é `nodeToSplit = Node.copy(node, txCtx)`.
        *   –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —É–∑–µ–ª `newNode = Node.createLeaf/Node(tree, txCtx)` (–æ–Ω —Å—Ä–∞–∑—É –ø–æ–ø–∞–¥–µ—Ç –≤ `txCtx.workingNodes` —á–µ—Ä–µ–∑ `register_node`).
        *   –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª—é—á–∏/—É–∫–∞–∑–∞—Ç–µ–ª–∏ –º–µ–∂–¥—É `nodeToSplit` –∏ `newNode`.
        *   –û–±–Ω–æ–≤–ª—è–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è (—Ç–æ–∂–µ —á–µ—Ä–µ–∑ –∫–æ–ø–∏—é, –ø–æ–ª—É—á–µ–Ω–Ω—É—é –∏–∑ `txCtx`).
        *   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª—é—á-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∏ ID –Ω–æ–≤—ã—Ö –¥–µ—Ç–µ–π).
3.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –°–≤—è–∑–µ–π (`parent`, `left`, `right`):**
    *   –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–ø–∏–π –∏ –∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ "—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—É—é" –≤–µ—Ä—Å–∏—é –¥–µ—Ä–µ–≤–∞ –Ω—É–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å ID —Ä–æ–¥–∏—Ç–µ–ª—è, –ª–µ–≤–æ–≥–æ –∏ –ø—Ä–∞–≤–æ–≥–æ —Å–æ—Å–µ–¥–∞ —É *–∫–æ–ø–∏–π*.

**IV. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–∞–º—è—Ç—å—é / –°–±–æ—Ä–∫–∞ –ú—É—Å–æ—Ä–∞ –°—Ç–∞—Ä—ã—Ö –í–µ—Ä—Å–∏–π (–°–ª–æ–∂–Ω–∞—è –ß–∞—Å—Ç—å MVCC)**

*   –ö–æ–≥–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –∏ –µ–µ CoW-–∫–æ–ø–∏–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è "–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏", —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —É–∑–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∑–∞–º–µ–Ω–µ–Ω—ã, —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ.
*   –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (—Å–Ω–∞–ø—à–æ—Ç—ã), –∫–æ—Ç–æ—Ä—ã–µ –≤—Å–µ –µ—â–µ –º–æ–≥—É—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–∏ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏, –∏—Ö –Ω–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å —Å—Ä–∞–∑—É.
*   –ù—É–∂–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è, –∫–∞–∫–∏–µ –≤–µ—Ä—Å–∏–∏ —É–∑–ª–æ–≤ –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Å–Ω–∞–ø—à–æ—Ç–∞–º–∏.
*   **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:**
    *   **–°—á–µ—Ç—á–∏–∫–∏ —Å—Å—ã–ª–æ–∫ –Ω–∞ –≤–µ—Ä—Å–∏–∏:** –°–ª–æ–∂–Ω–æ –∏ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –æ—à–∏–±–∫–∞–º.
    *   **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞:** –ü—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç "–æ—Å–∏—Ä–æ—Ç–µ–≤—à–∏–µ" –≤–µ—Ä—Å–∏–∏ —É–∑–ª–æ–≤ (–Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ç —Å—Å—ã–ª–æ–∫ –∏–∑ `tree.nodes` –∏ –Ω–µ—Ç —Å—Å—ã–ª–æ–∫ –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö `TransactionContext.snapshotRootId`).
    *   **–î–ª—è JavaScript:** –ï—Å–ª–∏ —Å—Ç–∞—Ä—ã–µ —É–∑–ª—ã –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –ø–æ —Å—Å—ã–ª–∫–∞–º –∏–∑ `tree.nodes` –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞ JS —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –∏—Ö —É–¥–∞–ª–∏—Ç. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä—ã–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏.

**V. `actions.ts`**

*   –§—É–Ω–∫—Ü–∏–∏ `remove` –∏ `update` –≤ `actions.ts` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∞–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–º API `BPlusTree`.
*   –û–Ω–∏ –±—É–¥—É—Ç –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫—É—Ä—Å–æ—Ä–∞–º (–ø–æ–ª—É—á–µ–Ω–Ω—ã–º –∏–∑ —Å–Ω–∞–ø—à–æ—Ç–∞), –∞ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ `bPlusTree.remove(key, txCtx)` –∏–ª–∏ `bPlusTree.update(key, newValue, txCtx)`.

**–ü—Ä–∏–º–µ—Ä–Ω—ã–π –ü–ª–∞–Ω –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π):**

1.  **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `Node` –∏ `methods.ts` –¥–ª—è CoW:**
    *   –í–Ω–µ–¥—Ä–∏—Ç–µ `Node.copy`.
    *   –ò–∑–º–µ–Ω–∏—Ç–µ –º–µ—Ç–æ–¥—ã —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å –∫–æ–ø–∏—è–º–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –Ω–æ–≤—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã/ID. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –º–æ–∂–Ω–æ –ø–æ–∫–∞ –Ω–µ –≤–≤–æ–¥–∏—Ç—å `TransactionContext`, –∞ –ø—Ä–æ—Å—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ. `BPlusTree.insert/remove` –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å *–Ω–æ–≤—ã–π* —ç–∫–∑–µ–º–ø–ª—è—Ä `BPlusTree` —Å –Ω–æ–≤—ã–º –∫–æ—Ä–Ω–µ–º –∏ –∫–∞—Ä—Ç–æ–π —É–∑–ª–æ–≤. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ—Ç–ª–∞–¥–∏—Ç—å CoW-–ª–æ–≥–∏–∫—É.
2.  **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ `TransactionContext` –∏ 2PC API –≤ `BPlusTree`:**
    *   –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ `TransactionContext`.
    *   –ò–∑–º–µ–Ω–∏—Ç–µ –º–µ—Ç–æ–¥—ã `BPlusTree.insert/remove` –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ `methods.ts` –¥–ª—è –ø—Ä–∏–µ–º–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `TransactionContext`. –û–Ω–∏ —Ç–µ–ø–µ—Ä—å –±—É–¥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å `workingNodes` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ, –∞ –Ω–µ —Å–∞–º `BPlusTree`.
        *   _(`remove_in_transaction` –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –∏–¥–µ—Ç —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ `insert_in_transaction`)_
    *   –†–µ–∞–ª–∏–∑—É–π—Ç–µ `prepareCommit`, `commit`, `rollback`.
3.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `collection-store`:**
    *   `collection-store` –¥–æ–ª–∂–µ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å `TransactionContext`, –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ–≥–æ –≤ `BPlusTree` –∏ –≤—ã–∑—ã–≤–∞—Ç—å 2PC-–º–µ—Ç–æ–¥—ã.
4.  **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è MVCC-–∞—Å–ø–µ–∫—Ç–æ–≤:**
    *   –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —á–∏—Ç–∞—Ç–µ–ª–µ–π —Å–æ —Å–Ω–∞–ø—à–æ—Ç–∞–º–∏.
    *   –ú–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ `prepareCommit` (–Ω–∞–ø—Ä–∏–º–µ—Ä, optimistic locking: –µ—Å–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ —Å—Ç–∞—Ä—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–µ–µ `snapshotRootId`) –∫—Ç–æ-—Ç–æ —É–∂–µ –∏–∑–º–µ–Ω–∏–ª –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏–ª —É–∑–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–∫—É—â–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å, —Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç).
    *   –ü—Ä–æ–¥—É–º–∞—Ç—å —Å–±–æ—Ä–∫—É –º—É—Å–æ—Ä–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π —É–∑–ª–æ–≤.

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
–¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ CoW, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –≤ `split/merge/borrow` –∏ –ª–æ–≥–∏–∫–∏ MVCC (–∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, —Å–Ω–∞–ø—à–æ—Ç—ã).

–≠—Ç–æ –±–æ–ª—å—à–∞—è –∏ —Å–ª–æ–∂–Ω–∞—è –∑–∞–¥–∞—á–∞. –ù–∞—á–Ω–∏—Ç–µ —Å CoW-–ø—Ä–∏–Ω—Ü–∏–ø–∞ –¥–ª—è —É–∑–ª–æ–≤ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—É—é –æ–±–≤—è–∑–∫—É. –£–¥–∞—á–∏!