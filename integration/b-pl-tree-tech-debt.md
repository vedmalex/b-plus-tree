# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –∏ –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ `b-pl-tree`

## –û–±–∑–æ—Ä

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `b-pl-tree` —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏, –Ω–æ –≤ —Ç–µ–∫—É—â–µ–º –≤–∏–¥–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤–∞–∂–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤ `collection-store`. –ü–æ–ø—ã—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É "–Ω–∞ –ª–µ—Ç—É" –ø—É—Ç–µ–º –µ–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å –∏–∑-–∑–∞ –Ω–µ–æ–±—ä—è—Å–Ω–∏–º—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å–æ —Å—Ä–µ–¥–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º `bun`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é –∫–æ–¥–∞, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `src`.

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –ø–æ –µ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π, —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø–∞–∫–µ—Ç–æ–º `b-pl-tree`.

---

## üéØ –°—É—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞

### 1. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

*   **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –æ–¥–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `docId`) –∏–∑ –∏–Ω–¥–µ–∫—Å–∞, –µ—Å–ª–∏ –ø–æ –æ–¥–Ω–æ–º—É –∫–ª—é—á—É —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π. –ú–µ—Ç–æ–¥ `remove` –ª–∏–±–æ –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏—á–µ–≥–æ, –ª–∏–±–æ —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ –∫–ª—é—á—É.
*   **–°–∏–º–ø—Ç–æ–º:** –¢–µ—Å—Ç `should remove one document from a non-unique key` –≤ `IndexManager.test.ts` –ø—Ä–æ–≤–∞–ª–µ–Ω –∏ –ø—Ä–æ–ø—É—â–µ–Ω (`it.skip`).
*   **–ê–Ω–∞–ª–∏–∑:** –û—Ç–ª–∞–¥–∫–∞ –ø–æ–∫–∞–∑–∞–ª–∞ –¥–≤–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
    1.  –§—É–Ω–∫—Ü–∏—è `find` –¥–ª—è –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `[['doc1'], ['doc1']]` –≤–º–µ—Å—Ç–æ `[['doc1']]`), —á—Ç–æ –Ω–∞—Ä—É—à–∞–ª–æ –ª–æ–≥–∏–∫—É –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
    2.  –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `removeSpecific` –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–º–µ–Ω—è–ª–∞ —Ñ–∏–ª—å—Ç—Ä—É—é—â–∏–π –ø—Ä–µ–¥–∏–∫–∞—Ç –∫–æ –≤—Å–µ–º—É –º–∞—Å—Å–∏–≤—É —É–∫–∞–∑–∞—Ç–µ–ª–µ–π, –∞ –Ω–µ –∫ –µ–≥–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º.
*   **–ë–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ñ–∞–∫—Ç–æ—Ä:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `bun` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ `b-pl-tree` –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏.

### 2. –ù–µ—Ä–∞–±–æ—á–∏–µ Range-–∑–∞–ø—Ä–æ—Å—ã (–ø–æ–∏—Å–∫–∞ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É)

*   **–ü—Ä–æ–±–ª–µ–º–∞:** –í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É (`<`, `>`, `<=`, `>=`).
*   **–°–∏–º–ø—Ç–æ–º:** –í–µ—Å—å –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ `describe.skip('findRange', ...)` –≤ `IndexManager.test.ts` –ø—Ä–æ–ø—É—â–µ–Ω. –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ `range()` –∏–∑ `b-pl-tree` –ø—Ä–∏–≤–æ–¥–∏–ª–∏ –∫ –æ—à–∏–±–∫–µ `is not a function`.
*   **–ë–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ñ–∞–∫—Ç–æ—Ä:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç—Ç–æ–π –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –¥–≤–∏–∂–∫–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ `QueryEngine` –Ω–∏—á–µ–≥–æ, –∫—Ä–æ–º–µ –ø–æ–∏—Å–∫–∞ –ø–æ —Ç–æ—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é.

### 3. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏ –Ω–µ–ø–æ–ª–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

*   **–ü—Ä–æ–±–ª–µ–º–∞:** –í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ "—á—Ç–µ–Ω–∏—è-–∏–∑–º–µ–Ω–µ–Ω–∏—è-–∑–∞–ø–∏—Å–∏" –≤ —Ä–∞–º–∫–∞—Ö ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤.
*   **–°–∏–º–ø—Ç–æ–º:** –í–µ—Å—å –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ `describe.skip('IndexManager Transactions', ...)` –ø—Ä–æ–ø—É—â–µ–Ω.
*   **–ê–Ω–∞–ª–∏–∑:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è `b-pl-tree` –æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥—ã –≤—Ä–æ–¥–µ `get_all_in_transaction`, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö. –û–¥–Ω–∞–∫–æ –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (`1.3.0`) —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –ë–µ–∑ –Ω–∏—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –º–∞—Å—Å–∏–≤ `docId`, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∏ –∑–∞–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—è –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö (race conditions).

---

## üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ—Ö–¥–æ–ª–≥–∞

–≠—Ç–æ—Ç –ø–ª–∞–Ω –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –ø–∞–∫–µ—Ç–æ–º `b-pl-tree` –∫–∞–∫ –Ω–∞–¥ **–æ—Ç–¥–µ–ª—å–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º**, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å —á–∏—Å—Ç–æ—Ç—É —Å—Ä–µ–¥—ã –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Å–±–æ—Ä–∫–∏.

### –§–∞–∑–∞ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ä–µ–¥—ã –∏ –±–∞–∑–æ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)

1.  **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞:** –†–∞–±–æ—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º `b-pl-tree`.
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏:**
    *   –í—ã–ø–æ–ª–Ω–∏—Ç—å `bun install` –≤ –∫–æ—Ä–Ω–µ `b-pl-tree`.
    *   –í–Ω–µ—Å—Ç–∏ –ø—Ä–æ—Å—Ç–æ–µ, –Ω–æ –∑–∞–º–µ—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ `src` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `console.log` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ `BPlusTree`).
    *   –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏: `bun run build`.
    *   **–ö–ª—é—á–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏–∑ `src` –æ—Ç—Ä–∞–∂–µ–Ω–æ –≤ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –≤ `dist/`. **–ï—Å–ª–∏ –Ω–µ—Ç, –¥–∞–ª—å–Ω–µ–π—à–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞ –¥–æ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–±–æ—Ä–∫–æ–π.**
3.  **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`bun test`). –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ—à–∏–±–∫–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é –æ—Å–Ω–æ–≤—É.

### –§–∞–∑–∞ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ (2-3 –¥–Ω—è)

1.  **–°–æ–∑–¥–∞—Ç—å —Ü–µ–ª–µ–≤–æ–π —Ç–µ—Å—Ç:** –í–Ω—É—Ç—Ä–∏ `b-pl-tree` –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –ø–∞–¥–∞—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–∑ `IndexManager.test.ts` (–≤—Å—Ç–∞–≤–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ).
2.  **–ò—Å–ø—Ä–∞–≤–∏—Ç—å `find`:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `find(key)` –¥–ª—è –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑, –∞ –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç –µ–≥–æ.
3.  **–ò—Å–ø—Ä–∞–≤–∏—Ç—å `removeSpecific` / `delete_in_node`:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ª–æ–≥–∏–∫—É, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–µ–¥–∏–∫–∞—Ç –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ *–∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É* –º–∞—Å—Å–∏–≤–∞ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π, –∞ –Ω–µ –∫–æ –≤—Å–µ–º—É –º–∞—Å—Å–∏–≤—É. –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —É–∑–µ–ª —Å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º –º–∞—Å—Å–∏–≤–æ–º.
4.  **–ò—Ç–µ—Ä–∞—Ü–∏—è:** –î–æ–±–∏—Ç—å—Å—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞.

### –§–∞–∑–∞ 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Range-–∑–∞–ø—Ä–æ—Å–æ–≤ (2-3 –¥–Ω—è)

1.  **–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç:** –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –º–µ—Ç–æ–¥–∞ `range()`, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–µ —Å–ª—É—á–∞–∏ `>`, `<`, `>=`, `<=`, –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ–ª–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω.
2.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `range()`:** –ù–∞–ø–∏—Å–∞—Ç—å –∏–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `range()`. –õ–æ–≥–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤–∫–ª—é—á–∞—Ç—å:
    *   –ü–æ–∏—Å–∫ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —É–∑–ª–∞ (`from` key).
    *   –ò—Ç–µ—Ä–∞—Ü–∏—é –ø–æ —É–∑–ª–∞–º –∏ –∏—Ö –∫–ª—é—á–∞–º –≤–ø—Ä–∞–≤–æ.
    *   –°–±–æ—Ä –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω `to` key.
3.  **–î–æ–±–∏—Ç—å—Å—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤.**

### –§–∞–∑–∞ 4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (3-5 –¥–Ω–µ–π)

1.  **–ò–∑—É—á–µ–Ω–∏–µ `TransactionContext`:** –ì–ª—É–±–æ–∫–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `TransactionContext.ts`, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º Copy-on-Write (CoW).
2.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `getAllInTransaction(key, txContext)`. –û–Ω –¥–æ–ª–∂–µ–Ω —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ "—Å–Ω–∏–º–∫–∞" —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –≤–Ω–µ—à–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
3.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—É—é –∑–∞–ø–∏—Å—å:** –ù–∞ –æ—Å–Ω–æ–≤–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª "—á—Ç–µ–Ω–∏–µ-–∏–∑–º–µ–Ω–µ–Ω–∏–µ-–∑–∞–ø–∏—Å—å" –¥–ª—è `remove_in_transaction` –¥–ª—è –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π.

### –§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

1.  **–ü—É–±–ª–∏–∫–∞—Ü–∏—è:** –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é `b-pl-tree` –≤ npm (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫ `1.3.1` –∏–ª–∏ `1.4.0`).
2.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `collection-store`:** –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é `b-pl-tree` –≤ `package.json` –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.
3.  **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –≤—Å–µ `.skip` –∏–∑ —Ç–µ—Å—Ç–æ–≤ `IndexManager` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ `collection-store`, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ –≤–µ—Å—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ —É—Å—Ç—Ä–∞–Ω–µ–Ω.

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞ –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏

### 1. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –Ω–µ—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
- [x] `should allow duplicate keys when unique is false` (`src/test/BPlusTree.test.ts`)
- [x] `should remove the correct item when duplicates exist (using remove)`
- [x] `should remove all items with the same key using removeMany`
- [x] `should remove specific items using a predicate`
- [x] `removeSpecific should not remove items if predicate returns false`
- [x] `should remove duplicate keys one by one using remove_in_transaction` (`src/test/bptree.test.ts`)
- [x] `should remove all duplicate keys using remove_in_transaction(key, txCtx, true)`
- [x] `Advanced Duplicate Removal > should remove duplicates one by one sequentially using remove_in_transaction`

### 2. –ù–µ—Ä–∞–±–æ—á–∏–µ Range-–∑–∞–ø—Ä–æ—Å—ã
- [x] `should find keys within a given range using range() method` (`src/test/BPlusTree.test.ts`)
- [x] `should handle range edge cases`
- [x] `range should filter items within the key range [inclusive]` (`src/test/query.test.ts`)
- [x] `range should filter items within the key range (exclusive)`
- [x] `sourceRange should yield items within the range (inclusive)` (`src/test/source.test.ts`)
- [x] `sourceRange should yield items within the range (exclusive)`
- [x] `sourceRange should handle empty ranges`

### 3. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏ –Ω–µ–ø–æ–ª–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- [x] `BPlusTree Transactional Operations` (insert_in_transaction, isolation, rollback) (`src/test/BPlusTree.test.ts`)
- [x] `BPlusTree Transactional Duplicate Key Handling` (get_all_in_transaction, remove_in_transaction)
- [x] `BPlusTree remove_in_transaction > should remove a key from a leaf node without underflow` (`src/test/BPlusTreeTransactionRemove.test.ts`)
- [x] `should correctly process key removal in #do_remove_cow for a leaf`
- [x] `should handle borrowing/merging in remove_in_transaction with underflow`
- [x] `TransactionContext Savepoint Support` (savepoint, rollback, commit, abort) (`src/test/TransactionContext.savepoint.test.ts`)
- [x] `get_all_in_transaction` (—Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)
- [x] `remove_in_transaction` (—Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏)

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `collection-store` (–≤–Ω–µ—à–Ω–∏–π –ø—Ä–æ–µ–∫—Ç, –Ω–µ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏)

**–í—ã–≤–æ–¥:** –í—Å–µ –ø—É–Ω–∫—Ç—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞ –ø–æ –∫–æ–¥—É –∏ —Ç–µ—Å—Ç–∞–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏. –û—Ç–∫—Ä—ã—Ç–∞ —Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω—è—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è.